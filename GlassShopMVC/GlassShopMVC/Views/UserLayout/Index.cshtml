
@{
    Layout = null;
}
<!DOCTYPE html>
<html lang="en">
<head>
    <!-- basic -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <!-- mobile metas -->
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="viewport" content="initial-scale=1, maximum-scale=1">
    <!-- site metas -->
    <title>GlassShop</title>
    <meta name="keywords" content="">
    <meta name="description" content="">
    <meta name="author" content="">
    <!-- bootstrap css -->
    <link rel="stylesheet" href="../Content/greeno/css/bootstrap.min.css">
    <!-- style css -->
    <link rel="stylesheet" href="../Content/greeno/css/style.css">
    <!-- Responsive-->
    <link rel="stylesheet" href="../Content/greeno/css/responsive.css">
    <!-- fevicon -->
    <link rel="icon" href="../Content/greeno/images/fevicon.png" type="image/gif" />
    <!-- Scrollbar Custom CSS -->
    <link rel="stylesheet" href="../Content/greeno/css/jquery.mCustomScrollbar.min.css">
    <!-- Tweaks for older IEs-->
    <link rel="stylesheet" href="https://netdna.bootstrapcdn.com/font-awesome/4.0.3/../Content/greeno/font-awesome.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.5/jquery.fancybox.min.css" media="screen">
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script><![endif]-->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.0/css/all.min.css" rel="stylesheet" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.3.1/dist/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.js"></script>
</head>
<style>
    .error {
        color: red;
    }

    label.required:after {
        content: '*';
        color: red;
    }

    .nice-select {
        display: none !important;
    }
</style>
<!-- body -->
<body class="main-layout">
    <!-- loader  -->
    <div class="loader_bg">
        <div class="loader"><img src="../Content/greeno/images/loading.gif" alt="#" /></div>
    </div>
    <!-- end loader -->
    <!-- header -->
    <header>
        <!-- header inner -->
        <div class="header">
            <div class="container">
                <div class="row">
                    <div class="col-xl-3 col-lg-3 col-md-3 col-sm-3 col logo_section">
                        <div class="full">
                            <div class="center-desk">
                                <div class="logo"> <a href="index.html"><img src="https://banner2.cleanpng.com/20180806/gl/kisspng-sunglasses-logo-product-design-trademark-whitling-eye-co-benjamin-whitling-od-5b68df86892643.4611747415335996225618.jpg" alt="#"></a> </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-xl-9 col-lg-9 col-md-9 col-sm-9">
                        <div class="menu-area">
                            <div class="limit-box">
                                <nav class="main-menu">
                                    <ul class="menu-area-main">
                                        <li><a href="#plant">GLASS SHOP</a></li>
                                        <li>
                                            <a href="#gallery" data-toggle="modal" data-target="#cartModal" onclick="openCartInfo()">
                                                <i class="fa fa-cart-plus" aria-hidden="true"></i> <span style="color:red" id="countCart"></span>
                                            </a>
                                        </li>
                                        <li>
                                            <a href="#gallery" data-toggle="modal" data-target="#orderModal" onclick="openOrderInfo()">
                                                <i class="fa fa-shopping-bag" aria-hidden="true"></i> <span style="color:red" id="countOrder"></span>
                                            </a>
                                        </li>
                                        <li id="userIcon" style="display: none">
                                            <a href="#" id="accountInfo">
                                            </a>
                                        </li>
                                        <li>
                                            <div class="dropdown">
                                                <a class="dropdown-toggle" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                                    <i class="fa fa-sign-in" aria-hidden="true"></i>
                                                </a>
                                                <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
                                                    <a class="dropdown-item" href="#" data-toggle="modal" data-target="#loginModal" onclick="openLoginModal()">Login</a>
                                                    <a class="dropdown-item" href="#" data-toggle="modal" onclick="logout()">Logout</a>
                                                    <a class="dropdown-item" href="#" data-toggle="modal" data-target="#registerModal" onclick="openRegisterModal()">Register</a>
                                                    <a class="dropdown-item" href="#" data-toggle="modal" data-target="#changePassModal" onclick="openChangePassModal()">ChangePass</a>
                                                </div>
                                            </div>
                                        </li>
                                    </ul>
                                </nav>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- end header inner -->
    </header>
    <!-- end header -->
    <section>
        <div id="main_slider" class="carousel slide banner-main" data-ride="carousel">
            <ol class="carousel-indicators">
                <li data-target="#main_slider" data-slide-to="0" class="active"></li>
                <li data-target="#main_slider" data-slide-to="1"></li>
                <li data-target="#main_slider" data-slide-to="2"></li>
            </ol>
            <div class="carousel-inner">
                <div class="carousel-item active">
                    <div class="container">
                        <div class="row marginii">
                            <div class="col-xl-6 col-lg-6 col-md-6 col-sm-12">
                                <div class="carousel-caption ">
                                    <h1>Welcome to <strong class="color">GLASS SHOP</strong></h1>
                                    <p>Buy cheap and stylish eyeglasses online at GlassesShop. We carry a wide selection of prescription glasses, sunglasses and glasses frames and more</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                @*SLIDER*@
            </div>
        </div>
    </section>
    <!-- plant -->
    <div id="plant" class="plants">
        <div class="container">
            <div class="row">
                <div class="col-md-12 ">
                    <div class="titlepage">
                        <h2>Products</h2>
                    </div>
                </div>
            </div>
        </div>
        <div class="container">
            <div class="row">
                @foreach (var f in @ViewBag.ListProduct)
                {
                    <div class="col-xl-4 col-lg-4 col-md-6 col-sm-12">
                        <div class="plants-box" style="border-radius: 35px;">
                            <figure><img src="@f.Thumbnail" alt="img" style="border-top-left-radius: 35px; border-top-right-radius: 35px; height: 400px" /></figure>
                            <div class="col-md-6" style="margin-top: 10px;">
                                <select class="form-select form-control" aria-label="Default select example" id="selectColor-@f.ProductId">
                                    <option selected>Choose color</option>
                                    @foreach (var c in @ViewBag.ListColor)
                                    {
                                        <option style="background-color: @c.Color; color: @c.Color" value="@c.ProductColorId">@c.Color</option>
                                    }
                                </select>
                            </div>
                            <h3 style="font-weight: bold; font-family: cursive; font-style: italic; color: #d15757;">@f.ProductName</h3>
                            <p style="font-style: italic; margin-bottom: 0 !important; line-height: 10px;">Category: @f.CategoryName</p>
                            <p style="font-style: italic; margin-bottom: 0 !important; line-height: 10px;">Brand: @f.BrandName</p>
                            <p style="font-style: italic; margin-bottom: 0 !important; line-height: 10px;">Gender: @f.GenderName</p>
                            <p style="font-style: italic; margin-bottom: 0 !important; line-height: 10px;">@f.Descrip</p>
                            <p>
                                <button type="button" class="btn btn-outline-primary">@f.UnitPrice VNĐ</button>
                                <button type="button" class="btn btn-outline-primary" onclick="addToCart(@f.ProductId)">Add to Cart +</button>
                            </p>
                        </div>
                    </div>
                }
            </div>
        </div>
    </div>
    <div id="gallery" class="Gallery">
        <div class="container">
            <div class="row">
                <div class="col-md-12">
                    <div class="titlepage">
                        <h2>Our Gallery </h2>
                    </div>
                </div>
            </div>
        </div>
        <div class="container-fluid margin-r-l">
            <div class="row">
                <div class="col-xl-3 col-lg-3 col-md-3 col-sm-12 thumb">
                    <div class="Gallery-box">
                        <figure>
                            <a href="../Content/greeno/images/1.jpg" class="fancybox" rel="ligthbox">
                                <img src="../Content/greeno/images/1.jpg" class="zoom img-fluid " alt="">
                            </a>
                            <span class="hoverle">
                                <a href="../Content/greeno/images/1.jpg" class="fancybox" rel="ligthbox">View</a>
                            </span>
                        </figure>
                    </div>
                </div>
                <div class="col-xl-3 col-lg-3 col-md-3 col-sm-12 thumb">
                    <div class="Gallery-box">
                        <figure>
                            <a href="../Content/greeno/images/2.jpg" class="fancybox" rel="ligthbox">
                                <img src="../Content/greeno/images/2.jpg" class="zoom img-fluid " alt="">
                            </a>
                            <span class="hoverle">
                                <a href="../Content/greeno/images/1.jpg" class="fancybox" rel="ligthbox">View</a>
                            </span>
                        </figure>
                    </div>
                </div>
                <div class="col-xl-6 col-lg-6 col-md-6 col-sm-12 thumb">
                    <div class="Gallery-box">
                        <figure>
                            <a href="../Content/greeno/images/3.jpg" class="fancybox" rel="ligthbox">
                                <img src="../Content/greeno/images/3.jpg" class="zoom img-fluid " alt="">
                            </a>
                            <span class="hoverle">
                                <a href="../Content/greeno/images/3.jpg" class="fancybox" rel="ligthbox">View</a>
                            </span>
                        </figure>
                    </div>
                </div>
                <div class="col-xl-3 col-lg-3 col-md-3 col-sm-12 thumb">
                    <div class="Gallery-box">
                        <figure>
                            <a href="../Content/greeno/images/4.jpg" class="fancybox" rel="ligthbox">
                                <img src="../Content/greeno/images/4.jpg" class="zoom img-fluid " alt="">
                            </a>
                            <span class="hoverle">
                                <a href="../Content/greeno/images/4.jpg" class="fancybox" rel="ligthbox">View</a>
                            </span>
                        </figure>
                    </div>
                </div>
                <div class="col-xl-3 col-lg-3 col-md-3 col-sm-12 thumb">
                    <div class="Gallery-box">
                        <figure>
                            <a href="../Content/greeno/images/5.jpg" class="fancybox" rel="ligthbox">
                                <img src="../Content/greeno/images/5.jpg" class="zoom img-fluid " alt="">
                            </a>
                            <span class="hoverle">
                                <a href="../Content/greeno/images/5.jpg" class="fancybox" rel="ligthbox">View</a>
                            </span>
                        </figure>
                    </div>
                </div>
                <div class="col-xl-6 col-lg-6 col-md-6 col-sm-12">
                    <div class="Gallery-box">
                        <figure>
                            <a href="../Content/greeno/images/6.jpg" class="fancybox" rel="ligthbox">
                                <img src="../Content/greeno/images/6.jpg" class="zoom img-fluid " alt="">
                            </a>
                            <span class="hoverle">
                                <a href="../Content/greeno/images/6.jpg" class="fancybox" rel="ligthbox">View</a>
                            </span>
                        </figure>
                    </div>
                </div>
            </div>
        </div>
        <!-- end Gallery -->
        <!--contact -->
        <div id="contact" class="contact">
            <div class="container">
                <div class="row">
                    <div class="col-md-12">
                        <div class="titlepage">
                            <h2>Contact Us</h2>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-xl-4 col-lg-4 col-md-12 col-sm-12 paddimg-right">
                        <div class="row">
                            <div class="col-xl-12 col-lg-12 col-md-12 col-sm-12">
                                <form>
                                    <div class="row">
                                        <div class="col-xl-12 col-lg-12 col-md-12 col-sm-12">
                                            <input class="form-control" placeholder="Name" type="text" name="Name">
                                        </div>
                                        <div class="col-xl-12 col-lg-12 col-md-12 col-sm-12">
                                            <input class="form-control" placeholder="Email" type="text" name="Email">
                                        </div>
                                        <div class="col-xl-12 col-lg-12 col-md-12 col-sm-12">
                                            <input class="form-control" placeholder="Phone" type="text" name="Phone">
                                        </div>
                                        <div class="col-xl-12 col-lg-12 col-md-12 col-sm-12">
                                            <textarea class="textarea>" placeholder="Message" type="text" name="Message"></textarea>
                                        </div>
                                        <div class="col-xl-12 col-lg-12 col-md-12 col-sm-12">
                                            <a href="#">Read More</a>
                                        </div>
                                    </div>
                                </form>
                            </div>
                            <div class="col-xl-12 col-lg-12 col-md-12 col-sm-12">
                                <div class="map_section">
                                    <figure><img src="../Content/greeno/images/map.jpg"></figure>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-xl-8 col-lg-8 col-md-12 col-sm-12 paddimg-left">
                        <div class="Nursery-img">
                            <figure>
                                <img src="../Content/greeno/images/contactimg.jpg" alt="img" />
                                <div class="text-box">
                                    <h3>Best Green Nursery</h3>
                                </div>
                            </figure>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- end contact -->
        <!-- footer -->
        <footer>
            <div id="contact" class="footer">
                <div class="container">
                    <div class="row pdn-top-30">
                        <div class="col-md-12 ">
                            <div class="footer-box">
                                <div class="headinga">
                                    <h3>Address</h3>
                                    <span>Demo Store .New York  United States</span>
                                    <p>(+71 98765348)</p>
                                </div>
                                <ul class="location_icon">
                                    <li> <a href="#"><img src="icon/facebook.png"></a></li>
                                    <li> <a href="#"><img src="icon/Twitter.png"></a></li>
                                    <li> <a href="#"><img src="icon/linkedin.png"></a></li>
                                    <li> <a href="#"><img src="icon/instagram.png"></a></li>
                                </ul>
                                <div class="menu-bottom">
                                    <ul class="link">
                                        <li> <a href="#">Home</a></li>
                                        <li> <a href="#">About</a></li>
                                        <li> <a href="#"> Plant</a></li>
                                        <li> <a href="#">Gallery</a></li>
                                        <li> <a href="#"> Contact us</a></li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="copyright">
                    <div class="container">
                        <p>Copyright 2019 All Rights Reserved Design By  <a href="https://html.design/">Free Html Templates</a></p>
                    </div>
                </div>
            </div>
        </footer>
        <!-- end footer -->
        <!-- Javascript files-->
        <script src="../Content/greeno/js/jquery.min.js"></script>
        <script src="../Content/greeno/js/popper.min.js"></script>
        <script src="../Content/greeno/js/bootstrap.bundle.min.js"></script>
        <script src="../Content/greeno/js/jquery-3.0.0.min.js"></script>
        <script src="../Content/greeno/js/plugin.js"></script>
        <!-- sidebar -->
        <script src="../Content/greeno/js/jquery.mCustomScrollbar.concat.min.js"></script>
        <script src="../Content/greeno/js/custom.js"></script>
        <!-- javascript -->
        <script src="../Content/greeno/js/owl.carousel.js"></script>
        <script src="https:cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.5/jquery.fancybox.min.js"></script>
        <script>

            async function postData(url = '', data = {}) {
                // Default options are marked with *
                const response = await fetch(url, {
                    method: 'POST', // *GET, POST, PUT, DELETE, etc.
                    mode: 'cors', // no-cors, *cors, same-origin
                    cache: 'no-cache', // *default, no-cache, reload, force-cache, only-if-cached
                    credentials: 'same-origin', // include, *same-origin, omit
                    headers: {
                        'Content-Type': 'application/json'
                        // 'Content-Type': 'application/x-www-form-urlencoded',
                    },
                    redirect: 'follow', // manual, *follow, error
                    referrerPolicy: 'no-referrer', // no-referrer, *no-referrer-when-downgrade, origin, origin-when-cross-origin, same-origin, strict-origin, strict-origin-when-cross-origin, unsafe-url
                    body: JSON.stringify(data) // body data type must match "Content-Type" header
                });
                return response.json(); // parses JSON response into native JavaScript objects
            }

            var check = false;
            var count_cart = 0;
            var user_id = 0;
            var listMessageBouqueti = [];
            var dataCartItem = [];
            var gender = null;

            checkGender = (_gender) => {
                gender = _gender;
            }

            getCountCart = () => {
                $.ajax({
                    url: '/UserLayout/GetCountCart?accountId=' + user_id,
                    type: 'GET',
                    success: function (result) {
                        if (result) {
                            $('#countCart').html('(' + result + ')');
                            $('#cartItemCount').html('You have ' + result + ' items in your cart');
                        }
                        else {
                            toastr.warning('Failed !');
                            $('.modal').modal('hide');
                        }
                    }
                });
            }

            getCountOrder = () => {
                $.ajax({
                    url: '../UserLayout/GetCountOrder?accountId=' + user_id,
                    type: 'GET',
                    success: function (result) {
                        if (result) {
                            $('#countOrder').html('(' + result + ')');
                            $('#orderItemCount').html('You have ' + result + ' items in your order');
                        }
                        else {
                            toastr.warning('Failed !');
                            $('.modal').modal('hide');
                        }
                    }
                });
            }

            $(document).ready(function () {

                $(".fancybox").fancybox({
                    openEffect: "none",
                    closeEffect: "none"
                });

                $(".zoom").hover(function () {

                    $(this).addClass('transition');
                }, function () {

                    $(this).removeClass('transition');
                });

                if (localStorage.getItem("UserInfo")) {
                    check = true;
                    var info = JSON.parse(localStorage.getItem("UserInfo"));
                    user_id = info.AccountId;
                    $('#userIcon').show();
                    $('#accountInfo').append('<i class="fa-solid fa-user"></i> ' + info.UserName);
                    getCountCart();
                    getCountOrder();
                }
            });

            openLoginModal = () => {
                $('#username').val('');
                $('#password').val('');
            }

            openRegisterModal = () => {
                $('#f_name').val('');
                $('#l_name').val('');
                $('#dob').val('');
                gender = null;
                $('#phone').val('');
                $('#address').val('');
                $('#email_r').val('');
                $('#username_r').val('');
                $('#password_r').val('');
            }

            openChangePassModal = () => {
                $('#email_cp').val('');
                $('#username_cp').val('');
                $('#oldpassword_cp').val('');
                $('#oldpassword_cp').val('');
                $('#password_cp').val('');
            }

            login = () => {
                var reqUser = {
                    UserName: $('#username').val(),
                    PassWord: $('#password').val(),
                }

                postData('../Account/Login', reqUser)
                    .then((data) => {
                        if (data.success) {
                            var userInfo = {
                                AccountId: data.data.AccountId,
                                Admin: data.data.Admin,
                                UserName: data.data.UserName,
                                Token: data.token
                            };
                            console.log(userInfo);
                            $('.modal').modal('hide');
                            localStorage.setItem("UserInfo", JSON.stringify(userInfo));

                            if (localStorage.getItem("UserInfo") && !check) {
                                var info = JSON.parse(localStorage.getItem("UserInfo"));
                                $('#userIcon').show();
                                $('#accountInfo').html('<i class="fa-solid fa-user"></i> ' + info.UserName)
                            }
                            $('.modal').modal('hide');
                            window.location.reload();
                        }
                        else {
                            toastr.warning('Wrong password or username !');
                            $('.modal').modal('hide');
                        }
                    });
            }

            register = () => {
                var req = {
                    Email: $('#email_r').val(),
                    UserName: $('#username_r').val(),
                    Password: $('#password_r').val()
                }

                postData('../UserLayout/Register', req)
                    .then((data) => {
                        if (data.success) {
                            toastr.success(data.data);
                            $('.modal').modal('hide');
                        }
                        else {
                            toastr.warning(data.data);
                            $('.modal').modal('hide');
                        }
                    });
            }

            changePassword = () => {
                var req = {
                    UserName: $('#username_cp').val(),
                    OldPassword: $('#oldpassword_cp').val(),
                    Password: $('#oldpassword_cp').val(),
                    NewPassword: $('#password_cp').val(),
                    Email: $('#email_cp').val()
                }

                postData('../UserLayout/ChangePass', req)
                    .then((data) => {
                        if (data.success) {
                            toastr.success(data.data);
                            $('.modal').modal('hide');
                        }
                        else {
                            toastr.warning(data.data);
                            $('.modal').modal('hide');
                        }
                    });
            }

            logout = () => {
                localStorage.removeItem("UserInfo");
                window.location.reload();
            }

            addToCart = (id) => {
                if (!localStorage.getItem("UserInfo")) {
                    toastr.warning('You need to login for adding to cart !');
                }
                else {
                    $.ajax({
                        url: '../UserLayout/InsertCartItem?accountId=' + user_id + '&productColorId=' + $('#selectColor-' + id).val(),
                        type: 'GET',
                        success: function (result) {
                            if (result) {
                                toastr.success('Add to cart successfully !');
                                getCountCart();
                            }
                            else {
                                toastr.warning('Failed !');
                                $('.modal').modal('hide');
                            }
                        }
                    });
                }
            }

            openCartInfo = () => {
                var totalPrice = 0;
                if (!localStorage.getItem("UserInfo")) {
                    $('#notLogin').show();
                    $('.infoCart').hide();
                }
                else {
                    $.ajax({
                        url: '../UserLayout/GetCartItem?accountId=' + user_id,
                        type: 'GET',
                        success: function (result) {
                            if (result) {
                                dataCartItem = result.data;
                                var _html = '';
                                result.data.forEach(x => {
                                    var str = `<div class="card mb-3">
                                        <div class="card-body">
                                            <div class="d-flex justify-content-between">
                                                <div class="d-flex flex-row align-items-center">
                                                    <div>
                                                        <img src="`+ x.Thumbnail + `"
                                                                class="img-fluid rounded-3" alt="Shopping item" style="width: 65px;">
                                                    </div>
                                                    <div class="col-md-10">
                                                        <h5 style="margin-left: 10px;">`+ x.ProductName + `</h5>
                                                        <div style="margin-left: 10px;background-color:${x.Color}; width:20px;height:20px;" class="small mb-0"></div>
                                                        <p style="margin-left: 10px;" class="small mb-0">${x.Descrip ?? ""}</p>
                                                    </div>
                                                </div>
                                                <div class="d-flex flex-row align-items-center">
                                                    <div style="width: 85px;">
                                                        <input style="width: 60px;" id="count_${x.OrderProductId}" type="number" value="${x.Quantity}" min="1"/>
                                                    </div>
                                                    <div style="width: 150px;">
                                                        <h5 class="mb-0">$ `+ `${x.Quantity} x ${x.UnitPrice}` + `</h5>
                                                    </div>
                                                    <a href="#!" style="color:#308409;;margin-right:20px;font-size:25px;font-weight:bold" onclick="updateCountCart(${x.OrderProductId}, '#count_${x.OrderProductId}')"><i class="fa fa-check" aria-hidden="true"></i></a>
                                                    <a href="#!" style="color: #cecece;" onclick="deleteCartItem(`+ x.OrderProductId + `)"><i class="fas fa-trash-alt"></i></a>
                                                </div>
                                            </div>
                                        </div>
                                    </div>`;
                                    _html += str;
                                })
                                $('#displayCartItem').html(_html);
                            }
                            else {
                                toastr.warning('Failed !');
                                $('.modal').modal('hide');
                            }
                        }
                    });
                    $('#notLogin').hide();
                    $('.infoCart').show();
                }
            }

            updateCountCart = (cartItemId, id_count) => {
                var count_update = $(id_count).val();
                var totalPrice = 0;
                $.ajax({
                    url: '../UserLayout/UpdateCountCart?orderProductId=' + cartItemId + '&count=' + count_update,
                    type: 'GET',
                    success: function (result) {
                        if (result.success) {
                            toastr.success('Update count successfully !');
                            getCountCart();
                            $.ajax({
                                url: '../UserLayout/GetCartItem?accountId=' + user_id,
                                type: 'GET',
                                success: function (result) {
                                    if (result) {
                                        dataCartItem = result.data;
                                        var _html = '';
                                        result.data.forEach(x => {
                                            var str = `<div class="card mb-3">
                                        <div class="card-body">
                                            <div class="d-flex justify-content-between">
                                                <div class="d-flex flex-row align-items-center">
                                                    <div>
                                                        <img src="`+ x.Thumbnail + `"
                                                                class="img-fluid rounded-3" alt="Shopping item" style="width: 65px;">
                                                    </div>
                                                    <div class="col-md-10">
                                                        <h5 style="margin-left: 10px;">`+ x.ProductName + `</h5>
                                                        <div style="margin-left: 10px;background-color:${x.Color}; width:20px;height:20px;" class="small mb-0"></div>
                                                        <p style="margin-left: 10px;" class="small mb-0">${x.Descrip ?? ""}</p>
                                                    </div>
                                                </div>
                                                <div class="d-flex flex-row align-items-center">
                                                    <div style="width: 85px;">
                                                        <input style="width: 60px;" id="count_${x.OrderProductId}" type="number" value="${x.Quantity}" min="1"/>
                                                    </div>
                                                    <div style="width: 150px;">
                                                        <h5 class="mb-0">$ `+ `${x.Quantity} x ${x.UnitPrice}` + `</h5>
                                                    </div>
                                                    <a href="#!" style="color:#308409;;margin-right:20px;font-size:25px;font-weight:bold" onclick="updateCountCart(${x.OrderProductId}, '#count_${x.OrderProductId}')"><i class="fa fa-check" aria-hidden="true"></i></a>
                                                    <a href="#!" style="color: #cecece;" onclick="deleteCartItem(`+ x.OrderProductId + `)"><i class="fas fa-trash-alt"></i></a>
                                                </div>
                                            </div>
                                        </div>
                                    </div>`;
                                            _html += str;
                                        })
                                        $('#displayCartItem').html(_html);
                                    }
                                    else {
                                        toastr.warning('Failed !');
                                        $('.modal').modal('hide');
                                    }
                                }
                            });
                        }
                        else {
                            toastr.warning('Failed !');
                            $('.modal').modal('hide');
                        }
                    }
                });
            }


            getTotalPrice = (orderId) => {
                $.ajax({
                    url: '../UserLayout/GetTotalPrice?orderId=' + orderId,
                    type: 'GET',
                    success: function (result) {
                        return result;
                    }
                })
            }

            openOrderInfo = () => {
                $.ajax({
                    url: '../UserLayout/GetOrderByUserId?accountId=' + user_id,
                    type: 'GET',
                    success: function (result) {
                        if (result) {
                            var _html = '';
                            result.data.forEach(x => {
                                var str = `<div class="card mb-3">
                                    <div class="card-body">
                                        <div class="d-flex justify-content-between">
                                            <div class="d-flex flex-row align-items-center">
                                                <div class="col-md-12">
                                                    <p class="small mb-0">ORDER CODE: `+ x.OrderId + `</p>
                                                    <h6 style="margin-left: 10px;">`+ x.StatusName + `</h6>
                                                </div>
                                            </div>
                                            <div class="d-flex flex-row align-items-center">
                                                <div style="width: 120px;">
                                                    <h5 class="mb-0">`+ x.TotalPrice + ` VNĐ</h5>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>`;
                                _html += str;
                            })
                            $('#table_order').html(_html);
                        }
                        else {
                            toastr.warning('Failed !');
                            $('.modal').modal('hide');
                        }
                    }
                })
            }

            deleteCartItem = (id) => {
                var totalPrice = 0;
                $.ajax({
                    url: '../UserLayout/DeleteCartItem?orderProductId=' + id,
                    type: 'GET',
                    success: function (result) {
                        if (result.success) {
                            getCountCart();
                            $.ajax({
                                url: '../UserLayout/GetCartItem?accountId=' + user_id,
                                type: 'GET',
                                success: function (result) {
                                    if (result) {
                                        dataCartItem = result.data;
                                        var _html = '';
                                        result.data.forEach(x => {
                                            var str = `<div class="card mb-3">
                                        <div class="card-body">
                                            <div class="d-flex justify-content-between">
                                                <div class="d-flex flex-row align-items-center">
                                                    <div>
                                                        <img src="`+ x.Thumbnail + `"
                                                                class="img-fluid rounded-3" alt="Shopping item" style="width: 65px;">
                                                    </div>
                                                    <div class="col-md-10">
                                                        <h5 style="margin-left: 10px;">`+ x.ProductName + `</h5>
                                                        <div style="margin-left: 10px;background-color:${x.Color}; width:20px;height:20px;" class="small mb-0"></div>
                                                        <p style="margin-left: 10px;" class="small mb-0">${x.Descrip ?? ""}</p>
                                                    </div>
                                                </div>
                                                <div class="d-flex flex-row align-items-center">
                                                    <div style="width: 85px;">
                                                        <input style="width: 60px;" id="count_${x.OrderProductId}" type="number" value="${x.Quantity}" min="1"/>
                                                    </div>
                                                    <div style="width: 150px;">
                                                        <h5 class="mb-0">$ `+ `${x.Quantity} x ${x.UnitPrice}` + `</h5>
                                                    </div>
                                                    <a href="#!" style="color:#308409;;margin-right:20px;font-size:25px;font-weight:bold" onclick="updateCountCart(${x.OrderProductId}, '#count_${x.OrderProductId}')"><i class="fa fa-check" aria-hidden="true"></i></a>
                                                    <a href="#!" style="color: #cecece;" onclick="deleteCartItem(`+ x.OrderProductId + `)"><i class="fas fa-trash-alt"></i></a>
                                                </div>
                                            </div>
                                        </div>
                                    </div>`;
                                            _html += str;
                                        })
                                        $('#displayCartItem').html(_html);
                                    }
                                    else {
                                        toastr.warning('Failed !');
                                        $('.modal').modal('hide');
                                    }
                                }
                            });
                        }
                        else {
                            toastr.warning('Failed !');
                        }
                    }
                });
            }

            var formatDate = (month, day, year, hour, minute) => {
                month = month + 1;
                if (month < 10) {
                    month = '0' + month;
                }
                if (day < 10) {
                    day = '0' + day;
                }
                if (hour < 10) {
                    hour = '0' + hour;
                }
                if (minute < 10) {
                    minute = '0' + minute;
                }
                return `${month}/${day}/${year} ${hour}:${minute}`;
            }

            placeOrder = () => {
                $.ajax({
                    url: '../UserLayout/PlaceOrder?accountId=' + user_id,
                    type: 'GET',
                    success: function (result) {
                        if (result.success) {
                            toastr.success('Your place order is successfully !');
                            $('.modal').modal('hide');
                            $('#countCart').html('(' + 0 + ')');
                            getCountOrder();
                        }
                        else {
                            toastr.warning('Failed !');
                            $('.modal').modal('hide');
                        }
                    }
                })
            }
        </script>
</body>
</html>


<div class="modal fade" id="loginModal" tabindex="-1" role="dialog" aria-labelledby="loginModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="loginModalLabel">Login</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <div class="col-md-12">
                    <div class="row">
                        <div class="col-md-12">
                            <label class="required" for="inputEmail4">User Name</label>
                            <input type="text" id="username" placeholder="User Name" class="form-control" value="" />
                            <p class="error" id="username_validate" style="display: none"></p>
                        </div>
                        <div class="col-md-12">
                            <label class="required" for="inputEmail4">Password</label>
                            <input type="password" id="password" placeholder="Password" class="form-control" value="" />
                            <p class="error" id="password_validate" style="display: none"></p>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                <button type="button" class="btn btn-primary" onclick="login()">Login</button>
            </div>
        </div>
    </div>
</div>


<div class="modal fade" id="registerModal" tabindex="-1" role="dialog" aria-labelledby="registerModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="registerModalLabel">Register</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <div class="col-md-12">
                    <div class="row">
                        <div class="col-md-12">
                            <label class="required" for="inputEmail4">Email</label>
                            <input type="text" id="email_r" placeholder="Email" class="form-control" value="" />
                            <p class="error" id="email_r_validate" style="display: none"></p>
                        </div>
                        <div class="col-md-12">
                            <label class="required" for="inputEmail4">User Name</label>
                            <input type="text" id="username_r" placeholder="User Name" class="form-control" value="" />
                            <p class="error" id="username_r_validate" style="display: none"></p>
                        </div>
                        <div class="col-md-12">
                            <label class="required" for="inputEmail4">Password</label>
                            <input type="password" id="password_r" placeholder="Password" class="form-control" value="" />
                            <p class="error" id="password_r_validate" style="display: none"></p>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                <button type="button" class="btn btn-primary" onclick="register()">Register</button>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="changePassModal" tabindex="-1" role="dialog" aria-labelledby="changePassModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="changePassModalLabel">Change Password</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <div class="col-md-12">
                    <div class="row">
                        <div class="col-md-12">
                            <label class="required" for="inputEmail4">Email</label>
                            <input type="text" id="email_cp" placeholder="Email" class="form-control" value="" />
                            <p class="error" id="email_cp_validate" style="display: none"></p>
                        </div>
                        <div class="col-md-12">
                            <label class="required" for="inputEmail4">User Name</label>
                            <input type="text" id="username_cp" placeholder="User Name" class="form-control" value="" />
                            <p class="error" id="username_cp_validate" style="display: none"></p>
                        </div>
                        <div class="col-md-12">
                            <label class="required" for="inputEmail4">Old Passowrd</label>
                            <input type="password" id="oldpassword_cp" placeholder="Password" class="form-control" value="" />
                            <p class="error" id="oldpassword_cp_validate" style="display: none"></p>
                        </div>
                        <div class="col-md-12">
                            <label class="required" for="inputEmail4">New Password</label>
                            <input type="password" id="password_cp" placeholder="Confirm Password" class="form-control" value="" />
                            <p class="error" id="password_cp_validate" style="display: none"></p>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                <button type="button" class="btn btn-primary" onclick="changePassword()">Confirm</button>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="cartModal" tabindex="-1" role="dialog" aria-labelledby="cartModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="cartModalLabel">Cart item</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <div class="infoCart" style="display: none">
                    <section class="h-100 h-custom" style="background-color: #eee;">
                        <div class="container py-5 h-100">
                            <div class="row d-flex justify-content-center align-items-center h-100">
                                <div class="col">
                                    <div class="card">
                                        <div class="card-body p-4">
                                            <div class="row">
                                                <div class="col-lg-12">
                                                    <div class="d-flex justify-content-between align-items-center mb-4">
                                                        <div>
                                                            <p class="mb-0">
                                                            </p>
                                                        </div>
                                                    </div>
                                                    <div id="displayCartItem">
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </section>
                </div>
                <div class="col-md-12" id="notLogin" style="display: none">
                    Bạn cần phải có tài khoản
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                <button type="button" class="infoCart btn btn-primary" onclick="placeOrder()">Place Order</button>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="orderModal" tabindex="-1" role="dialog" aria-labelledby="orderModalLabel" aria-hidden="true">
    <div class="modal-dialog modal=lg" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="orderModal">LIST ORDER</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <div id="table_order"></div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>